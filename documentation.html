<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Documentation - brokenrecord.studio</title>
        <meta
            name="description"
            content="Complete documentation for brokenrecord.studio - Physics as Code Programming Language"
        />

        <!-- Marked.js for markdown parsing -->
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

        <!-- Prism.js for syntax highlighting -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
            rel="stylesheet"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-elixir.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>

        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            :root {
                --bg-dark: #0a0a0f;
                --bg-gradient-start: #1a2e0f;
                --bg-gradient-end: #2e1a0f;
                --accent-purple: #a0522d;
                --accent-cyan: #10b981;
                --accent-pink: #ec4899;
                --accent-green: #22c55e;
                --accent-orange: #f59e0b;
                --accent-brown: #a0522d;
                --text-primary: #f8fafc;
                --text-secondary: #cbd5e1;
                --code-bg: #1e293b;
                --success: #10b981;
                --error: #ef4444;
                --card-bg: rgba(30, 41, 59, 0.5);
                --border-color: rgba(160, 82, 45, 0.2);
            }

            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
                    "Oxygen", "Ubuntu", "Cantarell", sans-serif;
                background: linear-gradient(
                    135deg,
                    var(--bg-gradient-start) 0%,
                    var(--bg-gradient-end) 100%
                );
                color: var(--text-primary);
                line-height: 1.6;
                overflow-x: hidden;
            }

            /* Animated background particles */
            .particles {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 0;
            }

            .particle {
                position: absolute;
                width: 4px;
                height: 4px;
                background: var(--accent-cyan);
                border-radius: 50%;
                opacity: 0.3;
                animation: float 20s infinite;
            }

            @keyframes float {
                0%,
                100% {
                    transform: translate(0, 0) rotate(0deg);
                }
                33% {
                    transform: translate(30px, -30px) rotate(120deg);
                }
                66% {
                    transform: translate(-30px, 30px) rotate(240deg);
                }
            }

            /* Container */
            .container {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 2rem;
                position: relative;
                z-index: 1;
            }

            /* Navigation */
            nav {
                padding: 2rem 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .logo {
                font-size: 1.5rem;
                font-weight: 700;
                background: linear-gradient(
                    135deg,
                    var(--accent-purple),
                    var(--accent-cyan)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }

            .nav-links {
                display: flex;
                gap: 2rem;
                list-style: none;
            }

            .nav-links a {
                color: var(--text-secondary);
                text-decoration: none;
                transition: color 0.3s;
                font-size: 0.95rem;
            }

            .nav-links a:hover {
                color: var(--accent-cyan);
            }

            .nav-links a.active {
                color: var(--accent-cyan);
            }

            /* Hero Section */
            .hero {
                padding: 4rem 0;
                text-align: center;
            }

            .hero h1 {
                font-size: 3.5rem;
                font-weight: 900;
                margin-bottom: 1.5rem;
                line-height: 1.1;
            }

            .hero h1 .gradient-text {
                background: linear-gradient(
                    135deg,
                    var(--accent-purple),
                    var(--accent-cyan),
                    var(--accent-pink)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                background-size: 200% 200%;
                animation: gradient-shift 3s ease infinite;
            }

            @keyframes gradient-shift {
                0%,
                100% {
                    background-position: 0% 50%;
                }
                50% {
                    background-position: 100% 50%;
                }
            }

            .hero p {
                font-size: 1.25rem;
                color: var(--text-secondary);
                margin-bottom: 2rem;
                max-width: 800px;
                margin-left: auto;
                margin-right: auto;
            }

            /* Search Bar */
            .search-container {
                max-width: 600px;
                margin: 0 auto 3rem;
                position: relative;
            }

            .search-input {
                width: 100%;
                padding: 1rem 3rem 1rem 1.5rem;
                border: 2px solid var(--border-color);
                border-radius: 50px;
                font-size: 1rem;
                transition: all 0.3s;
                background: var(--card-bg);
                color: var(--text-primary);
            }

            .search-input:focus {
                outline: none;
                border-color: var(--accent-cyan);
                box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);
            }

            .search-icon {
                position: absolute;
                right: 1.5rem;
                top: 50%;
                transform: translateY(-50%);
                color: var(--text-secondary);
            }

            /* Documentation Grid */
            .docs-container {
                display: grid;
                grid-template-columns: 250px 1fr;
                gap: 2rem;
                margin-bottom: 4rem;
            }

            /* Sidebar */
            .sidebar {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 16px;
                padding: 1.5rem;
                height: fit-content;
                position: sticky;
                top: 120px;
                backdrop-filter: blur(12px);
            }

            .sidebar h3 {
                font-size: 1rem;
                font-weight: 700;
                text-transform: uppercase;
                letter-spacing: 0.05em;
                margin-bottom: 1rem;
                color: var(--text-primary);
            }

            .doc-list {
                list-style: none;
            }

            .doc-item {
                margin-bottom: 0.5rem;
            }

            .doc-link {
                display: block;
                padding: 0.75rem 1rem;
                color: var(--text-secondary);
                text-decoration: none;
                border-radius: 8px;
                transition: all 0.2s;
                font-size: 0.9rem;
            }

            .doc-link:hover {
                background: rgba(6, 182, 212, 0.1);
                color: var(--accent-cyan);
                transform: translateX(5px);
            }

            .doc-link.active {
                background: rgba(6, 182, 212, 0.2);
                color: var(--accent-cyan);
                font-weight: 600;
                box-shadow: 0 2px 8px rgba(6, 182, 212, 0.1);
            }

            /* Content Area */
            .content {
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 16px;
                padding: 2.5rem;
                backdrop-filter: blur(12px);
            }

            .content h1 {
                font-size: 2.5rem;
                font-weight: 800;
                margin-bottom: 1rem;
                color: var(--text-primary);
            }

            .content h2 {
                font-size: 1.8rem;
                font-weight: 700;
                margin-top: 2rem;
                margin-bottom: 1rem;
                color: var(--text-primary);
            }

            .content h3 {
                font-size: 1.4rem;
                font-weight: 600;
                margin-top: 1.5rem;
                margin-bottom: 0.75rem;
                color: var(--text-primary);
            }

            .content p {
                margin-bottom: 1rem;
                color: var(--text-secondary);
                line-height: 1.7;
            }

            .content ul,
            .content ol {
                margin-bottom: 1rem;
                padding-left: 2rem;
            }

            .content li {
                margin-bottom: 0.5rem;
                color: var(--text-secondary);
            }

            .content code {
                background: var(--code-bg);
                padding: 0.2rem 0.4rem;
                border-radius: 4px;
                font-family: "Monaco", "Courier New", monospace;
                font-size: 0.9rem;
                color: var(--accent-cyan);
            }

            .content pre {
                background: var(--code-bg);
                color: var(--text-primary);
                padding: 1.5rem;
                border-radius: 8px;
                overflow-x: auto;
                margin-bottom: 1rem;
                border: 1px solid var(--border-color);
            }

            .content pre code {
                background: none;
                color: inherit;
                padding: 0;
            }

            .content blockquote {
                border-left: 4px solid var(--accent-purple);
                padding-left: 1rem;
                margin: 1rem 0;
                color: var(--text-secondary);
                font-style: italic;
            }

            .content table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 1rem;
            }

            .content th,
            .content td {
                padding: 0.75rem;
                text-align: left;
                border-bottom: 1px solid var(--border-color);
            }

            .content th {
                font-weight: 600;
                color: var(--text-primary);
                background: var(--card-bg);
            }

            /* Prism.js syntax highlighting overrides */
            .content pre[class*="language-"] {
                background: var(--code-bg);
                margin: 1rem 0;
                padding: 1rem;
                border-radius: 8px;
                overflow: auto;
                border: 1px solid var(--border-color);
            }

            .content code[class*="language-"] {
                background: none;
                color: inherit;
                padding: 0;
                font-family: "Monaco", "Courier New", monospace;
                font-size: 0.9rem;
            }

            /* Better table styling */
            .content table {
                border-collapse: collapse;
                width: 100%;
                margin: 1.5rem 0;
                border-radius: 8px;
                overflow: hidden;
                border: 1px solid var(--border-color);
            }

            .content th,
            .content td {
                padding: 0.75rem 1rem;
                text-align: left;
                border-bottom: 1px solid var(--border-color);
            }

            .content th {
                background: var(--card-bg);
                font-weight: 600;
                color: var(--text-primary);
            }

            .content tr:last-child td {
                border-bottom: none;
            }

            .content tr:hover {
                background: rgba(6, 182, 212, 0.05);
            }

            /* Footer */
            footer {
                background: var(--bg-dark);
                color: var(--text-secondary);
                padding: 60px 0 40px;
                margin-top: 4rem;
            }

            .footer-content {
                text-align: center;
                margin-bottom: 2rem;
            }

            .footer-content h3 {
                font-size: 1.75rem;
                font-weight: 900;
                background: linear-gradient(
                    135deg,
                    var(--accent-purple),
                    var(--accent-cyan)
                );
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                margin-bottom: 1rem;
            }

            .footer-content p {
                color: var(--text-secondary);
                line-height: 1.7;
            }

            .footer-bottom {
                border-top: 1px solid var(--border-color);
                padding-top: 2rem;
                text-align: center;
                color: var(--text-secondary);
                font-size: 0.9rem;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .hero h1 {
                    font-size: 2.5rem;
                }

                .docs-container {
                    grid-template-columns: 1fr;
                }

                .sidebar {
                    position: static;
                }

                .nav-links {
                    display: none;
                }
            }

            /* Loading state */
            .loading {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 200px;
                color: var(--text-secondary);
            }

            /* Error state */
            .error {
                background: rgba(239, 68, 68, 0.1);
                border: 1px solid rgba(239, 68, 68, 0.3);
                color: var(--error);
                padding: 1rem;
                border-radius: 8px;
                margin-bottom: 1rem;
            }
        </style>
    </head>
    <body>
        <!-- Animated particles background -->
        <div class="particles" id="particles"></div>

        <div class="container">
            <!-- Navigation -->
            <nav>
                <div class="logo">üéµ brokenrecord.studio</div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#features">Features</a></li>
                    <li>
                        <a href="documentation.html" class="active">Docs</a>
                    </li>
                    <li><a href="examples.html">Examples</a></li>
                    <li><a href="open-source.html">Source</a></li>
                    <li>
                        <a
                            href="https://github.com/c-u-l8er/brokenrecord.studio"
                            >GitHub</a
                        >
                    </li>
                </ul>
            </nav>

            <!-- Hero Section -->
            <section class="hero">
                <h1>
                    <span class="gradient-text">Documentation</span>
                </h1>
                <p>
                    Complete guides and references for brokenrecord.studio -
                    Physics as Code Programming Language
                </p>

                <!-- Search Bar -->
                <div class="search-container">
                    <input
                        type="text"
                        id="searchInput"
                        class="search-input"
                        placeholder="Search documentation..."
                    />
                    <div class="search-icon">üîç</div>
                </div>
            </section>

            <!-- Documentation Content -->
            <section class="docs-container">
                <!-- Sidebar -->
                <aside class="sidebar">
                    <h3>Documentation</h3>
                    <ul class="doc-list" id="docList">
                        <!-- Documents will be loaded here -->
                    </ul>
                </aside>

                <!-- Content Area -->
                <main class="content" id="contentArea">
                    <div class="loading">Loading documentation...</div>
                </main>
            </section>
        </div>

        <!-- Footer -->
        <footer>
            <div class="container">
                <div class="footer-content">
                    <h3>üéµ brokenrecord.studio</h3>
                    <p>
                        Physics-based programming language where conservation
                        laws are enforced through type constraints.
                    </p>
                </div>
                <div class="footer-bottom">
                    <p>&copy; <span id="current-year"></span> brokenrecord.studio. Artificial Interaction Intelligence. Version 2.0.</p>
                </div>
            </div>
        </footer>

        <div style="background: #000; padding: 2em 0 1em;">
            <div style="margin: 0 auto; width: 728px;">
                <iframe
                    src="https://ampersandboxdesign.com/advertisements/leaderboard-watermark.html"
                    width="728"
                    height="90"
                    frameborder="0"
                    scrolling="no"
                    style="border:none; overflow:hidden;"
                    title="AmperSandboxDesign Branding Design Agency Advertisement"
                >
                </iframe>
                <div style="text-align: right; color: #ccc; font-size: 0.75em;">
                    ^ADVERTISEMENT
                </div>
            </div>
        </div>

        <script>
            // Generate animated particles
            const particlesContainer = document.getElementById("particles");
            const particleCount = 50;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement("div");
                particle.className = "particle";
                particle.style.left = Math.random() * 100 + "%";
                particle.style.top = Math.random() * 100 + "%";
                particle.style.animationDelay = Math.random() * 20 + "s";
                particle.style.animationDuration =
                    15 + Math.random() * 10 + "s";
                particlesContainer.appendChild(particle);
            }

            // Set dynamic copyright year
            document.getElementById("current-year").textContent =
                new Date().getFullYear();

            // Documentation data
            let docs = [
                "01_migration_overview.md",
                "02_conservation_types.md",
                "03_zig_runtime.md",
                "04_hardware_dispatch.md",
                "05_implementation_roadmap.md",
                "accelerator_reference.md",
                "competitive_battle_card.md",
                "conservation_types_guide.md",
                "demo_applications.md",
                "faq.md",
                "PERFORMANCE.md",
                "records_field_service_example.md",
                "records_implementation_guide.md",
                "social_media_graphics.md",
                "technical_whitepaper.md",
            ];
            let currentDoc = null;
            let allDocsContent = {};

            // Initialize documentation
            async function initDocs() {
                try {
                    console.log("Initializing documentation...");

                    // Initialize marked.js
                    if (!initializeMarked()) {
                        console.warn(
                            "Marked.js initialization failed, continuing with basic functionality",
                        );
                    }

                    await loadAllDocs();
                    console.log(
                        "Documents loaded:",
                        Object.keys(allDocsContent),
                    );
                    renderDocList();

                    // Load first document by default or check URL hash
                    const hash = window.location.hash.substring(1);
                    if (hash && docs.includes(hash)) {
                        loadDocument(hash);
                    } else if (docs.length > 0) {
                        loadDocument(docs[0]);
                    }
                } catch (error) {
                    console.error("Error initializing documentation:", error);
                    showError(
                        `Failed to initialize documentation: ${error.message}`,
                    );
                }
            }

            // Load all documents
            async function loadAllDocs() {
                console.log(`Starting to load ${docs.length} documents...`);
                let loadedCount = 0;
                let failedCount = 0;

                for (const doc of docs) {
                    try {
                        console.log(`Loading document: ${doc}`);
                        const response = await fetch(`docs/${doc}`, { cache: 'no-cache' });
                        if (response.ok) {
                            const content = await response.text();
                            allDocsContent[doc] = content;
                            loadedCount++;
                            console.log(
                                `Successfully loaded ${doc} (${content.length} characters)`,
                            );
                        } else {
                            failedCount++;
                            console.error(
                                `Failed to load ${doc}: ${response.status} ${response.statusText}`,
                            );
                        }
                    } catch (error) {
                        failedCount++;
                        console.error(`Error loading ${doc}:`, error);
                    }
                }

                console.log(
                    `Document loading complete. Success: ${loadedCount}, Failed: ${failedCount}`,
                );

                if (loadedCount === 0) {
                    throw new Error("No documents could be loaded");
                }
            }

            // Render document list in sidebar
            function renderDocList() {
                const docList = document.getElementById("docList");
                docList.innerHTML = "";

                docs.forEach((doc) => {
                    const li = document.createElement("li");
                    li.className = "doc-item";

                    const a = document.createElement("a");
                    a.href = `#${doc}`;
                    a.className = "doc-link";
                    a.textContent = formatDocTitle(doc);
                    a.addEventListener("click", (e) => {
                        e.preventDefault();
                        loadDocument(doc);
                        window.location.hash = doc;
                    });

                    li.appendChild(a);
                    docList.appendChild(li);
                });
            }

            // Format document title
            function formatDocTitle(filename) {
                return filename
                    .replace(".md", "")
                    .replace(/-/g, " ")
                    .replace(/\b\w/g, (l) => l.toUpperCase());
            }

            // Load and display document
            async function loadDocument(docName) {
                try {
                    console.log(`Loading document: ${docName}`);

                    if (!allDocsContent[docName]) {
                        showError(
                            `Document ${docName} not found or could not be loaded.`,
                        );
                        return;
                    }

                    currentDoc = docName;

                    // Update active state in sidebar
                    document.querySelectorAll(".doc-link").forEach((link) => {
                        link.classList.remove("active");
                        if (link.getAttribute("href") === `#${docName}`) {
                            link.classList.add("active");
                        }
                    });

                    // Check if marked is available
                    if (typeof marked === "undefined") {
                        showError("Markdown parser (marked.js) not loaded.");
                        return;
                    }

                    // Convert markdown to HTML and display
                    const content = markdownToHtml(allDocsContent[docName]);
                    document.getElementById("contentArea").innerHTML = content;

                    // Re-run Prism.js highlighting for the newly added content
                    if (typeof Prism !== "undefined") {
                        Prism.highlightAll();
                    } else {
                        console.warn(
                            "Prism.js not loaded, syntax highlighting disabled.",
                        );
                    }
                } catch (error) {
                    console.error(`Error loading document ${docName}:`, error);
                    showError(`Failed to load document: ${error.message}`);
                }
            }

            // Initialize marked.js when available
            function initializeMarked() {
                if (typeof marked === "undefined") {
                    console.error("Marked.js not loaded");
                    return false;
                }

                try {
                    // Configure marked options with simpler approach
                    marked.setOptions({
                        highlight: function (code, lang) {
                            // Ensure code is a string
                            const codeStr =
                                typeof code === "string"
                                    ? code
                                    : String(code || "");
                            const language = lang || "plaintext";

                            if (Prism.languages[language]) {
                                try {
                                    console.log(
                                        "Highlighting code for language:",
                                        language,
                                    );
                                    console.log("Code type:", typeof codeStr);
                                    console.log(
                                        "Prism.languages[language] type:",
                                        typeof Prism.languages[language],
                                    );

                                    const highlighted = Prism.highlight(
                                        codeStr,
                                        Prism.languages[language],
                                        language,
                                    );
                                    console.log(
                                        "Highlighted type:",
                                        typeof highlighted,
                                    );
                                    console.log(
                                        "Highlighted value:",
                                        highlighted,
                                    );

                                    // Ensure highlighted is a string
                                    const result =
                                        typeof highlighted === "string"
                                            ? highlighted
                                            : String(highlighted || codeStr);
                                    console.log("Result type:", typeof result);
                                    return result;
                                } catch (error) {
                                    console.error(
                                        "Error highlighting code:",
                                        error,
                                    );
                                    return escapeHtml(codeStr);
                                }
                            }
                            return escapeHtml(codeStr);
                        },
                        langPrefix: "language-",
                        breaks: true,
                        gfm: true,
                    });

                    console.log("Marked.js initialized successfully");
                    return true;
                } catch (error) {
                    console.error("Error initializing marked.js:", error);
                    return false;
                }
            }

            // Convert markdown to HTML using Marked.js
            function markdownToHtml(markdown) {
                try {
                    if (typeof marked === "undefined") {
                        console.error(
                            "Marked.js not available, falling back to basic conversion",
                        );
                        return `<pre>${escapeHtml(String(markdown || ""))}</pre>`;
                    }

                    // Ensure markdown is a string
                    const markdownStr =
                        typeof markdown === "string"
                            ? markdown
                            : String(markdown || "");

                    return marked.parse(markdownStr);
                } catch (error) {
                    console.error("Error parsing markdown:", error);
                    const markdownStr =
                        typeof markdown === "string"
                            ? markdown
                            : String(markdown || "");
                    return `<div class="error">Error parsing markdown: ${error.message}</div><pre>${escapeHtml(markdownStr)}</pre>`;
                }
            }

            // Escape HTML to prevent XSS
            function escapeHtml(text) {
                const div = document.createElement("div");
                div.textContent = text;
                return div.innerHTML;
            }

            // Show error message
            function showError(message) {
                document.getElementById("contentArea").innerHTML = `
                    <div class="error">
                        <strong>Error:</strong> ${message}
                    </div>
                `;
            }

            // Search functionality
            document
                .getElementById("searchInput")
                .addEventListener("input", function (e) {
                    const searchTerm = e.target.value.toLowerCase();

                    if (!searchTerm) {
                        renderDocList();
                        return;
                    }

                    const docList = document.getElementById("docList");
                    docList.innerHTML = "";

                    docs.forEach((doc) => {
                        const title = formatDocTitle(doc).toLowerCase();
                        const content = allDocsContent[doc]
                            ? allDocsContent[doc].toLowerCase()
                            : "";

                        if (
                            title.includes(searchTerm) ||
                            content.includes(searchTerm)
                        ) {
                            const li = document.createElement("li");
                            li.className = "doc-item";

                            const a = document.createElement("a");
                            a.href = `#${doc}`;
                            a.className = "doc-link";
                            a.textContent = formatDocTitle(doc);
                            a.addEventListener("click", (e) => {
                                e.preventDefault();
                                loadDocument(doc);
                                window.location.hash = doc;
                            });

                            li.appendChild(a);
                            docList.appendChild(li);
                        }
                    });

                    if (docList.innerHTML === "") {
                        docList.innerHTML =
                            '<li class="doc-item"><div class="doc-link">No documents found</div></li>';
                    }
                });

            // Handle hash change
            window.addEventListener("hashchange", function () {
                const hash = window.location.hash.substring(1);
                if (hash && docs.includes(hash)) {
                    loadDocument(hash);
                }
            });

            // Initialize on DOM content loaded
            document.addEventListener("DOMContentLoaded", function () {
                console.log("DOM Content Loaded");

                // Check if external libraries are loaded
                console.log(
                    "Marked.js available:",
                    typeof marked !== "undefined",
                );
                console.log(
                    "Prism.js available:",
                    typeof Prism !== "undefined",
                );

                // Wait a bit for external libraries to load
                setTimeout(() => {
                    console.log("Initializing documentation after timeout...");
                    console.log(
                        "Marked.js available after timeout:",
                        typeof marked !== "undefined",
                    );
                    console.log(
                        "Prism.js available after timeout:",
                        typeof Prism !== "undefined",
                    );
                    initDocs();
                }, 500);
            });

            // Also initialize on window load as a fallback
            window.addEventListener("load", function () {
                console.log("Window loaded");
                if (Object.keys(allDocsContent).length === 0) {
                    console.log("Fallback initialization");
                    initDocs();
                }
            });
        </script>
    </body>
</html>
